; PlatformIO Project Configuration File
;
;   Build options: build flags, source filter
;   Upload options: custom upload port, speed and extra flags
;   Library options: dependencies, extra library storages
;   Advanced options: extra scripting
;
; Please visit documentation for the other options and examples
; http://docs.platformio.org/page/projectconf.html
[platformio]
env_default = hoverboard

[env:hoverboard]
platform = ststm32
board = genericSTM32F103RC
framework = stm32cube
build_flags =
    -Iinc
    -DF1
    -Wl,-TSTM32F103RCTx_FLASH.ld
    -Og
upload_protocol = stlink
debug_tool = stlink
debug_port = /dev/ttyUSB0 ; TODO: FIXS

[env:unlock]
platform = ststm32
extra_scripts = tools/reset_target.py
uploader = stlink
custom_option = -f interface/stlink-v2.cfg -f target/stm32f1x.cfg -c init -c "reset halt" -c "stm32f1x unlock 0"

; TODO:
; * Do I need to link the startup file?
; * Do the unlock with the original
; * Should I use jlink or stlink?